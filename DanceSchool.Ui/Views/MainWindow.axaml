<shadui:Window xmlns="https://github.com/avaloniaui"
               xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
               xmlns:vm="using:DanceSchool.Ui.ViewModels"
               xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
               xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
               xmlns:shadui="clr-namespace:ShadUI;assembly=ShadUI"
               xmlns:converters="using:DanceSchool.Ui.Converters"
               xmlns:views="using:DanceSchool.Ui.Views.Students"
               xmlns:groupViews="using:DanceSchool.Ui.Views.Groups"
               xmlns:instructorViews="using:DanceSchool.Ui.Views.Instructors"
               xmlns:classViews="using:DanceSchool.Ui.Views.Classes"
               xmlns:attendanceViews="using:DanceSchool.Ui.Views.Attendances"
               xmlns:studioViews="using:DanceSchool.Ui.Views.Studios"
               xmlns:dashboardViews="using:DanceSchool.Ui.Views.Dashboard"
               mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="800"
               x:Class="DanceSchool.Ui.Views.MainWindow"
               x:DataType="vm:MainWindowViewModel"
               Icon="/Assets/avalonia-logo.ico"
               Title="{Binding Title}"
               Width="1200" Height="800"
               >
    
    <shadui:Window.Hosts>
        <shadui:DialogHost 
            Manager="{Binding DialogManager}"
            Owner="{Binding RelativeSource={RelativeSource AncestorType=shadui:Window}}"/>
        <shadui:ToastHost Manager="{Binding ToastManager}" />
    </shadui:Window.Hosts>

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <shadui:Window.Resources>
        <converters:StringEqualsConverter x:Key="StringEquals"/>
        <converters:StringNotEqualsConverter x:Key="StringNotEquals"/>
    </shadui:Window.Resources>

    <Grid ColumnDefinitions="280,*">
        <shadui:Sidebar 
            Grid.Column="0"
            Background="{DynamicResource CardBackgroundColor}"
            BorderThickness="0,0,1,0"
            BorderBrush="{DynamicResource BorderColor}"
            Padding="16"
            MinWidth="280"
            Expanded="True">
            
            <shadui:Sidebar.Header>
                <StackPanel Spacing="16">
                    <Border 
                        Background="#1447E6" 
                        CornerRadius="8" 
                        Padding="16,12"
                        HorizontalAlignment="Stretch">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <Border
                                Background="White"
                                CornerRadius="6"
                                Width="32"
                                Height="32"
                                VerticalAlignment="Center">
                                <TextBlock 
                                    Classes="LucideIcon"
                                    Text="&#57442;"
                                    FontSize="16"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Foreground="#1447E6"/>
                            </Border>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock 
                                    Text="Танцювальна Школа"
                                    FontSize="16"
                                    FontWeight="Bold"
                                    Foreground="White"/>
                                <TextBlock 
                                    Text="Система Управління"
                                    FontSize="12"
                                    Foreground="White"
                                    Opacity="0.8"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </shadui:Sidebar.Header>

            <!-- Navigation Items -->
            <StackPanel Spacing="8">
                <TextBlock 
                    Classes="Caption Muted"
                    FontWeight="DemiBold"
                    Margin="16,16,8,8"
                    Text="НАВІГАЦІЯ"/>
                
                <shadui:SidebarItem 
                    Content="Головна"
                    Command="{Binding NavigateToCommand}"
                    CommandParameter="Dashboard">
                    <shadui:SidebarItem.Icon>
                        <TextBlock 
                            Classes="LucideIcon"
                            Text=""
                            FontSize="16"/>
                    </shadui:SidebarItem.Icon>
                </shadui:SidebarItem>

                <shadui:SidebarItem 
                    Content="Студенти"
                    Command="{Binding NavigateToCommand}"
                    CommandParameter="Students">
                    <shadui:SidebarItem.Icon>
                        <TextBlock 
                            Classes="LucideIcon"
                            Text=""
                            FontSize="16"/>
                    </shadui:SidebarItem.Icon>
                </shadui:SidebarItem>

                <shadui:SidebarItem 
                    Content="Групи"
                    Command="{Binding NavigateToCommand}"
                    CommandParameter="Groups">
                    <shadui:SidebarItem.Icon>
                        <TextBlock 
                            Classes="LucideIcon"
                            Text=""
                            FontSize="16"/>
                    </shadui:SidebarItem.Icon>
                </shadui:SidebarItem>

                <shadui:SidebarItem 
                    Content="Інструктори"
                    Command="{Binding NavigateToCommand}"
                    CommandParameter="Instructors">
                    <shadui:SidebarItem.Icon>
                        <TextBlock 
                            Classes="LucideIcon"
                            Text=""
                            FontSize="16"/>
                    </shadui:SidebarItem.Icon>
                </shadui:SidebarItem>

                <shadui:SidebarItem 
                    Content="Заняття"
                    Command="{Binding NavigateToCommand}"
                    CommandParameter="Classes">
                    <shadui:SidebarItem.Icon>
                        <TextBlock 
                            Classes="LucideIcon"
                            Text=""
                            FontSize="16"/>
                    </shadui:SidebarItem.Icon>
                </shadui:SidebarItem>

                <shadui:SidebarItem 
                    Content="Відвідування"
                    Command="{Binding NavigateToCommand}"
                    CommandParameter="Attendance">
                    <shadui:SidebarItem.Icon>
                        <TextBlock 
                            Classes="LucideIcon"
                            Text="&#57456;"
                            FontSize="16"/>
                    </shadui:SidebarItem.Icon>
                </shadui:SidebarItem>

                <shadui:SidebarItem 
                    Content="Студії"
                    Command="{Binding NavigateToCommand}"
                    CommandParameter="Studios">
                    <shadui:SidebarItem.Icon>
                        <TextBlock 
                            Classes="LucideIcon"
                            Text=""
                            FontSize="16"/>
                    </shadui:SidebarItem.Icon>
                </shadui:SidebarItem>
            </StackPanel>
        </shadui:Sidebar>

        <DockPanel Grid.Column="1">
            <Border 
                DockPanel.Dock="Top"
                Background="{DynamicResource CardBackgroundColor}"
                BorderThickness="0,0,0,1"
                BorderBrush="{DynamicResource BorderColor}"
                Padding="24,16">
                <StackPanel VerticalAlignment="Center">
                    <TextBlock 
                        Text="{Binding SelectedView}"
                        FontSize="24"
                        FontWeight="Bold"
                        Classes="h2"/>
                    <TextBlock 
                        Text="Ефективно керуйте своєю танцювальною школою"
                        Classes="Small Muted"
                        Margin="0,4,0,0"/>
                </StackPanel>
            </Border>

            <Panel Margin="24">
                <dashboardViews:DashboardView IsVisible="{Binding $parent[Panel].DataContext.SelectedView, Converter={StaticResource StringEquals}, ConverterParameter=Dashboard}"
                                             DataContext="{Binding DashboardViewModel}"/>

                <views:StudentsView IsVisible="{Binding $parent[Panel].DataContext.SelectedView, Converter={StaticResource StringEquals}, ConverterParameter=Students}"
                                   DataContext="{Binding StudentsViewModel}"/>

                <groupViews:GroupsView IsVisible="{Binding $parent[Panel].DataContext.SelectedView, Converter={StaticResource StringEquals}, ConverterParameter=Groups}"
                                      DataContext="{Binding GroupsViewModel}"/>

                <classViews:ClassesView IsVisible="{Binding $parent[Panel].DataContext.SelectedView, Converter={StaticResource StringEquals}, ConverterParameter=Classes}"
                                       DataContext="{Binding ClassesViewModel}"/>

                <instructorViews:InstructorsView IsVisible="{Binding $parent[Panel].DataContext.SelectedView, Converter={StaticResource StringEquals}, ConverterParameter=Instructors}"
                                                DataContext="{Binding InstructorsViewModel}"/>
                
                <attendanceViews:AttendancesView IsVisible="{Binding $parent[Panel].DataContext.SelectedView, Converter={StaticResource StringEquals}, ConverterParameter=Attendance}"
                                                 DataContext="{Binding AttendancesViewModel}"/>

                <!-- <StackPanel IsVisible="{Binding SelectedView, Converter={StaticResource StringEquals}, ConverterParameter=Attendance}" -->
                <!--            HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="16"> -->
                <!--     <TextBlock Classes="LucideIcon" Text="" FontSize="64" HorizontalAlignment="Center" Opacity="0.3"/> -->
                <!--     <attendanceViews:AttendancesView DataContext="{Binding AttendancesViewModel}"/> -->
                <!-- </StackPanel> -->

                <studioViews:StudiosView IsVisible="{Binding $parent[Panel].DataContext.SelectedView, Converter={StaticResource StringEquals}, ConverterParameter=Studios}"
                                         DataContext="{Binding StudiosViewModel}"/>
            </Panel>
        </DockPanel>
    </Grid>
</shadui:Window>
